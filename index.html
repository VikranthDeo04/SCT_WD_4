<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>To-Do App (Flask-Style, JS Only)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #e7eff6; }
    .page-container { max-width:540px; margin:60px auto; background:#fff; border-radius:8px; box-shadow:0 4px 20px #bbb7; padding:32px;}
    h1 { color:#0077b6; }
    .completed { text-decoration: line-through; color: #aaa; }
    .desc { font-size:0.97em; color:#6c757d; }
    .mb-05 { margin-bottom:.5rem!important; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <!-- Task List Page -->
  <div id="taskListPage" class="page-container">
    <h1 class="mb-4">üìù Task List</h1>
    <a href="#" id="addTaskNav" class="btn btn-success mb-3">Add New Task</a>
    <ul class="list-group mb-2" id="taskList"></ul>
    <div id="noTasksMsg" class="alert alert-info text-center mt-3" style="display:none;">No tasks found. Please add a new task!</div>
  </div>
  <!-- Add Task Page -->
  <div id="addTaskPage" class="page-container hidden">
    <h1 class="mb-4">Add a Task</h1>
    <form id="taskForm" class="mb-3">
      <input type="text" id="taskInput" class="form-control mb-05" placeholder="Task Title" required>
      <input type="datetime-local" id="taskDate" class="form-control mb-05">
      <textarea id="taskDesc" class="form-control mb-05" placeholder="Description (optional)"></textarea>
      <button type="submit" class="btn btn-primary" id="addBtn">Add Task</button>
    </form>
    <a href="#" id="goToTasksBtn" class="btn btn-secondary mb-2">Go to Task List</a>
  </div>
  <!-- Edit Task Page -->
  <div id="editTaskPage" class="page-container hidden">
    <h1>Edit Task</h1>
    <form id="editForm">
      <input type="text" id="editInput" class="form-control mb-05" required>
      <input type="datetime-local" id="editDate" class="form-control mb-05">
      <textarea id="editDesc" class="form-control mb-05"></textarea>
      <button type="submit" class="btn btn-success">Save</button>
      <a href="#" id="cancelEditBtn" class="btn btn-secondary ms-2">Cancel</a>
    </form>
  </div>
  <script>
    let tasks = JSON.parse(localStorage.getItem("tasks") || "[]");
    let editingIndex = null;
    // Page navigation
    function showPage(pageId) {
      ["taskListPage", "addTaskPage", "editTaskPage"].forEach(pid => {
        document.getElementById(pid).classList.toggle("hidden", pid !== pageId);
      });
    }
    // Task List rendering
    function renderTasks() {
      const list = document.getElementById("taskList");
      const msg = document.getElementById("noTasksMsg");
      list.innerHTML = "";
      if (tasks.length === 0) {
        msg.style.display = "block";
        return;
      }
      msg.style.display = "none";
      tasks.forEach((task, idx) => {
        const li = document.createElement("li");
        li.className = "list-group-item d-flex justify-content-between align-items-start" +
          (task.completed ? " completed" : "");
        // Content div
        const div = document.createElement("div");
        div.className = "ms-2 me-auto";
        // Title + due date
        const main = document.createElement("div");
        main.className = "fw-bold";
        main.textContent = task.text;
        if (task.date) {
          let badge = document.createElement("span");
          badge.className = "badge bg-info ms-2";
          badge.textContent = "Due: " + task.date;
          main.appendChild(badge);
        }
        div.appendChild(main);
        // Description
        if (task.description) {
          let descDiv = document.createElement("div");
          descDiv.className = "desc";
          descDiv.textContent = task.description;
          div.appendChild(descDiv);
        }
        li.appendChild(div);
        // Action btns
        const actions = document.createElement("div");
        actions.className = "btn-group";
        // Complete/Undo
        const completeBtn = document.createElement("button");
        completeBtn.className = "btn btn-success btn-sm";
        completeBtn.textContent = task.completed ? "Undo" : "‚úî";
        completeBtn.onclick = () => { toggleComplete(idx); };
        // Edit
        const editBtn = document.createElement("button");
        editBtn.className = "btn btn-warning btn-sm";
        editBtn.textContent = "‚úèÔ∏è";
        editBtn.onclick = () => { showEditPage(idx); };
        // Delete
        const deleteBtn = document.createElement("button");
        deleteBtn.className = "btn btn-danger btn-sm";
        deleteBtn.textContent = "üóëÔ∏è";
        deleteBtn.onclick = () => { deleteTask(idx); };
        actions.append(completeBtn, editBtn, deleteBtn);
        li.appendChild(actions);
        list.appendChild(li);
      });
      localStorage.setItem("tasks", JSON.stringify(tasks));
    }
    // Add page logic
    document.getElementById("taskForm").onsubmit = function(e) {
      e.preventDefault();
      const text = document.getElementById("taskInput").value.trim();
      const date = document.getElementById("taskDate").value;
      const desc = document.getElementById("taskDesc").value.trim();
      if (text === "") return;
      tasks.push({ text, date, description: desc, completed: false });
      localStorage.setItem("tasks", JSON.stringify(tasks));
      this.reset();
      showPage("taskListPage");
      renderTasks();
    };
    document.getElementById("addTaskNav").onclick = function() {
      showPage("addTaskPage");
      document.getElementById("taskForm").reset();
    };
    document.getElementById("goToTasksBtn").onclick = function() {
      showPage("taskListPage");
      renderTasks();
    };
    // Complete task
    function toggleComplete(idx) {
      tasks[idx].completed = !tasks[idx].completed;
      localStorage.setItem("tasks", JSON.stringify(tasks));
      renderTasks();
    }
    // Delete task
    function deleteTask(idx) {
      tasks.splice(idx, 1);
      localStorage.setItem("tasks", JSON.stringify(tasks));
      renderTasks();
    }
    // Edit page
    function showEditPage(idx) {
      editingIndex = idx;
      const task = tasks[idx];
      document.getElementById("editInput").value = task.text;
      document.getElementById("editDate").value = task.date || "";
      document.getElementById("editDesc").value = task.description || "";
      showPage("editTaskPage");
    }
    document.getElementById("editForm").onsubmit = function(e) {
      e.preventDefault();
      const text = document.getElementById("editInput").value.trim();
      const date = document.getElementById("editDate").value;
      const desc = document.getElementById("editDesc").value.trim();
      if (text === "" || editingIndex === null) return;
      tasks[editingIndex] = { text, date, description: desc, completed: false };
      localStorage.setItem("tasks", JSON.stringify(tasks));
      showPage("taskListPage");
      renderTasks();
      editingIndex = null;
    };
    document.getElementById("cancelEditBtn").onclick = function(e) {
      e.preventDefault();
      editingIndex = null;
      showPage("taskListPage");
      renderTasks();
    };
    // Init
    showPage("taskListPage");
    renderTasks();
  </script>
</body>
</html>
